\documentclass[11pt, one side, article]{memoir}


\settrims{0pt}{0pt} % page and stock same size
\settypeblocksize{*}{36.5pc}{*} % {height}{width}{ratio}
\setlrmargins{*}{*}{1} % {spine}{edge}{ratio}
\setulmarginsandblock{.98in}{.98in}{*} % height of typeblock computed
\setheadfoot{\onelineskip}{2\onelineskip} % {headheight}{footskip}
\setheaderspaces{*}{1.5\onelineskip}{*} % {headdrop}{headsep}{ratio}
\checkandfixthelayout


\usepackage{amsthm}
\usepackage{mathtools}

\usepackage[inline]{enumitem}
\usepackage{ifthen}
\usepackage[utf8]{inputenc} %allows non-ascii in bib file
\usepackage{xcolor}

\usepackage[backend=biber, backref=true, maxbibnames = 10, style = alphabetic]{biblatex}
\usepackage[bookmarks=true, colorlinks=true, linkcolor=blue!50!black,
citecolor=orange!50!black, urlcolor=orange!50!black, pdfencoding=unicode]{hyperref}
\usepackage[capitalize]{cleveref}

\usepackage{tikz}

\usepackage{amssymb}
\usepackage{newpxtext}
\usepackage[varg,bigdelims]{newpxmath}
\usepackage{mathrsfs}
\usepackage{dutchcal}
\usepackage{mathalfa}
\usepackage{fontawesome}
\usepackage{ebproof}
\usepackage{stmaryrd}
\usepackage{ebproof}
\usepackage{graphicx}

% xcolor %
	\newcommand{\myred}[1]{{\color{red!60!black}#1}}
	\newcommand{\myyellow}[1]{{\color{yellow!60!black}#1}}
	\newcommand{\mygreen}[1]{{\color{green!40!black}#1}}

% cleveref %
  \newcommand{\creflastconjunction}{, and\nobreakspace} % serial comma
  \crefformat{enumi}{\card#2#1#3}
  \crefalias{chapter}{section}


% biblatex %
  \addbibresource{Library20220131.bib} 

% hyperref %
  \hypersetup{final}

% enumitem %
  \setlist{nosep}
  \setlistdepth{6}



% tikz %



  \usetikzlibrary{ 
  	cd,
  	math,
  	decorations.markings,
		decorations.pathreplacing,
  	positioning,
  	arrows.meta,
  	shapes,
		shadows,
		shadings,
  	calc,
  	fit,
  	quotes,
  	intersections,
    circuits,
    circuits.ee.IEC
  }
  
  \tikzset{
biml/.tip={Glyph[glyph math command=triangleleft, glyph length=.95ex]},
bimr/.tip={Glyph[glyph math command=triangleright, glyph length=.95ex]},
}

\tikzset{
	tick/.style={postaction={
  	decorate,
    decoration={markings, mark=at position 0.5 with
    	{\draw[-] (0,.4ex) -- (0,-.4ex);}}}
  }
} 
\tikzset{
	slash/.style={postaction={
  	decorate,
    decoration={markings, mark=at position 0.5 with
    	{\draw[-] (.3ex,.3ex) -- (-.3ex,-.3ex);}}}
  }
} 

\newcommand{\upp}{\begin{tikzcd}[row sep=6pt]~\\~\ar[u, bend left=50pt, looseness=1.3, start anchor=east, end anchor=east]\end{tikzcd}}

\newcommand{\bito}[1][]{
	\begin{tikzcd}[ampersand replacement=\&, cramped]\ar[r, biml-bimr, "#1"]\&~\end{tikzcd}  
}
\newcommand{\bifrom}[1][]{
	\begin{tikzcd}[ampersand replacement=\&, cramped]\ar[r, bimr-biml, "{#1}"]\&~\end{tikzcd}  
}
\newcommand{\bifromlong}[2][]{
	\begin{tikzcd}[ampersand replacement=\&, column sep=#2, cramped]\ar[r, bimr-biml, "#1"]\&~\end{tikzcd}  
}

% Adjunctions
\newcommand{\adj}[5][30pt]{%[size] Cat L, Left, Right, Cat R.
\begin{tikzcd}[ampersand replacement=\&, column sep=#1]
  #2\ar[r, shift left=7pt, "#3"]
  \ar[r, phantom, "\scriptstyle\Rightarrow"]\&
  #5\ar[l, shift left=7pt, "#4"]
\end{tikzcd}
}

\newcommand{\adjr}[5][30pt]{%[size] Cat R, Right, Left, Cat L.
\begin{tikzcd}[ampersand replacement=\&, column sep=#1]
  #2\ar[r, shift left=7pt, "#3"]\&
  #5\ar[l, shift left=7pt, "#4"]
  \ar[l, phantom, "\scriptstyle\Leftarrow"]
\end{tikzcd}
}

\newcommand{\xtickar}[1]{\begin{tikzcd}[baseline=-0.5ex,cramped,sep=small,ampersand 
replacement=\&]{}\ar[r,tick, "{#1}"]\&{}\end{tikzcd}}
\newcommand{\xslashar}[1]{\begin{tikzcd}[baseline=-0.5ex,cramped,sep=small,ampersand 
replacement=\&]{}\ar[r,tick, "{#1}"]\&{}\end{tikzcd}}



  
  % amsthm %
\theoremstyle{definition}
\newtheorem{definitionx}{Definition}[chapter]
\newtheorem{examplex}[definitionx]{Example}
\newtheorem{remarkx}[definitionx]{Remark}
\newtheorem{notation}[definitionx]{Notation}


\theoremstyle{plain}

\newtheorem{theorem}[definitionx]{Theorem}
\newtheorem{proposition}[definitionx]{Proposition}
\newtheorem{corollary}[definitionx]{Corollary}
\newtheorem{lemma}[definitionx]{Lemma}
\newtheorem{warning}[definitionx]{Warning}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{proposition*}{Proposition}
\newtheorem*{corollary*}{Corollary}
\newtheorem*{lemma*}{Lemma}
\newtheorem*{warning*}{Warning}
%\theoremstyle{definition}
%\newtheorem{definition}[theorem]{Definition}
%\newtheorem{construction}[theorem]{Construction}

\newenvironment{example}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\lozenge$}\examplex}
  {\popQED\endexamplex}
  
 \newenvironment{remark}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\lozenge$}\remarkx}
  {\popQED\endremarkx}
  
  \newenvironment{definition}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\lozenge$}\definitionx}
  {\popQED\enddefinitionx} 

    
%-------- Single symbols --------%
	
\DeclareSymbolFont{stmry}{U}{stmry}{m}{n}
\DeclareMathSymbol\fatsemi\mathop{stmry}{"23}

\DeclareFontFamily{U}{mathx}{\hyphenchar\font45}
\DeclareFontShape{U}{mathx}{m}{n}{
      <5> <6> <7> <8> <9> <10>
      <10.95> <12> <14.4> <17.28> <20.74> <24.88>
      mathx10
      }{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}
\DeclareFontSubstitution{U}{mathx}{m}{n}
\DeclareMathAccent{\widecheck}{0}{mathx}{"71}

\ExplSyntaxOn
\NewDocumentEnvironment{sequation}{O{\fontsize{15pt}{15pt}\selectfont
}b}
 {
  \yufip_sequation:nnn {equation}{#1}{#2}
 }{}
\NewDocumentEnvironment{sequation*}{O{\fontsize{16pt}{16pt}\selectfont
}b}
 {
  \yufip_sequation:nnn {equation*}{#1}{#2}
 }{}
\cs_new_protected:Nn \yufip_sequation:nnn
 {
  \begin{#1}
  \mbox{#2$\displaystyle#3$}
  \end{#1}
 }
\ExplSyntaxOff

%-------- Renewed commands --------%

\renewcommand{\ss}{\subseteq}

%-------- Other Macros --------%


\DeclarePairedDelimiter{\present}{\langle}{\rangle}
\DeclarePairedDelimiter{\copair}{[}{]}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\corners}{\ulcorner}{\urcorner}
\DeclarePairedDelimiter{\ihom}{[}{]}

\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Mor}{Mor}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\cod}{cod}
\DeclareMathOperator{\idy}{idy}
\DeclareMathOperator{\comp}{com}
\DeclareMathOperator*{\colim}{colim}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\ob}{Ob}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\el}{El}
\DeclareMathOperator{\votimes}{\varotimes}




\newcommand{\const}[1]{\texttt{#1}}%a constant, or named element of a set
\newcommand{\Set}[1]{\mathsf{#1}}%a named set
\newcommand{\ord}[1]{\mathsf{#1}}%an ordinal
\newcommand{\cat}[1]{\mathcal{#1}}%a generic category
\newcommand{\Cat}[1]{\mathbf{#1}}%a named category
\newcommand{\fun}[1]{\mathrm{#1}}%a function
\newcommand{\Fun}[1]{\mathit{#1}}%a named functor




\newcommand{\id}{\mathrm{id}}
\newcommand{\then}{\mathbin{\fatsemi}}

\newcommand{\cocolon}{:\!}


\newcommand{\iso}{\cong}
\newcommand{\too}{\longrightarrow}
\newcommand{\tto}{\rightrightarrows}
\newcommand{\To}[2][]{\xrightarrow[#1]{#2}}
\renewcommand{\Mapsto}[1]{\xmapsto{#1}}
\newcommand{\Tto}[3][13pt]{\begin{tikzcd}[sep=#1, cramped, ampersand replacement=\&, text height=1ex, text depth=.3ex]\ar[r, shift left=2pt, "#2"]\ar[r, shift right=2pt, "#3"']\&{}\end{tikzcd}}
\newcommand{\Too}[1]{\xrightarrow{\;\;#1\;\;}}
\newcommand{\from}{\leftarrow}
\newcommand{\ffrom}{\leftleftarrows}
\newcommand{\From}[1]{\xleftarrow{#1}}
\newcommand{\Fromm}[1]{\xleftarrow{\;\;#1\;\;}}
\newcommand{\surj}{\twoheadrightarrow}
\newcommand{\inj}{\rightarrowtail}
\newcommand{\wavyto}{\rightsquigarrow}
\newcommand{\lollipop}{\multimap}
\newcommand{\imp}{\Rightarrow}
\renewcommand{\iff}{\Leftrightarrow}
\newcommand{\down}{\mathbin{\downarrow}}
\newcommand{\fromto}{\leftrightarrows}
\newcommand{\tickar}{\xtickar{}}
\newcommand{\slashar}{\xslashar{}}
\newcommand{\card}{\,^{\#}}


\newcommand{\inv}{^{-1}}
\newcommand{\op}{^\tn{op}}

\newcommand{\tn}[1]{\textnormal{#1}}
\newcommand{\ol}[1]{\overline{#1}}
\newcommand{\ul}[1]{\underline{#1}}
\newcommand{\wt}[1]{\widetilde{#1}}
\newcommand{\wh}[1]{\widehat{#1}}
\newcommand{\wc}[1]{\widecheck{#1}}
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}

\newcommand{\lin}[1]{\hspace{1pt}\ol{\hspace{-1pt}#1\hspace{-1pt}}\hspace{1pt}}


\newcommand{\bb}{\mathbb{B}}
\newcommand{\cc}{\mathbb{C}}
\newcommand{\nn}{\mathbb{N}}
\newcommand{\pp}{\mathbb{P}}
\newcommand{\qq}{\mathbb{Q}}
\newcommand{\zz}{\mathbb{Z}}
\newcommand{\rr}{\mathbb{R}}


\newcommand{\finset}{\Cat{Fin}}
\newcommand{\smset}{\Cat{Set}}
\newcommand{\smcat}{\Cat{Cat}}
\newcommand{\catsharp}{\Cat{Cat}^{\sharp}}
\newcommand{\ppolyfun}{\mathbb{P}\Cat{olyFun}}
\newcommand{\ccatsharp}{\mathbb{C}\Cat{at}^{\sharp}}
\newcommand{\ccatsharpdisc}{\mathbb{C}\Cat{at}^{\sharp}_{\tn{disc}}}
\newcommand{\ccatsharplin}{\mathbb{C}\Cat{at}^{\sharp}_{\tn{lin}}}
\newcommand{\ccatsharpdisccon}{\mathbb{C}\Cat{at}^{\sharp}_{\tn{disc,con}}}
\newcommand{\sspan}{\mathbb{S}\Cat{pan}}
\newcommand{\en}{\Cat{End}}

\newcommand{\List}{\Fun{List}}
\newcommand{\set}{\tn{-}\Cat{Set}}




\newcommand{\yon}{\mathcal{y}}
\newcommand{\poly}{\Cat{Poly}}
\newcommand{\Span}{\Cat{Span}}
\newcommand{\rect}{\Set{Rect}}
\newcommand{\polycart}{\poly^{\tn{cart}}}
\newcommand{\hh}{\mathcal{h}}
\newcommand{\ppoly}{\mathbb{P}\Cat{oly}}
\newcommand{\0}{\textsf{0}}
\newcommand{\1}{\tn{\textsf{1}}}
\newcommand{\tri}{\mathbin{\triangleleft}}
\newcommand{\triright}{\mathbin{\triangleright}}
\newcommand{\tripow}[1]{^{\tri #1}}
\newcommand{\indep}{\Fun{Indep}}
\newcommand{\duoid}{\Fun{Duoid}}
\newcommand{\jump}{\pi}
\newcommand{\jumpmap}{\lin{\jump}}
\newcommand{\founds}{\Yleft}
\newcommand{\cofree}{\mathfrak{c}}
\newcommand{\free}{\mathfrak{m}}

% lenses
\newcommand{\biglens}[2]{
     \begin{bmatrix}{\vphantom{f_f^f}#2} \\ {\vphantom{f_f^f}#1} \end{bmatrix}
}
\newcommand{\littlelens}[2]{
     \begin{bsmallmatrix}{\vphantom{f}#2} \\ {\vphantom{f}#1} \end{bsmallmatrix}
}
\newcommand{\lens}[2]{
  \relax\if@display
     \biglens{#1}{#2}
  \else
     \littlelens{#1}{#2}
  \fi
}

\newcommand{\indexcoclscale}[1]{\scalebox{.7}{#1}}
\newcommand{\cocl}[1]{
	\scriptsize\overset{\,\indexcoclscale{$#1$}}{\frown}\normalsize
}
\newcommand{\hyper}[1]{
	\begin{tikzpicture}[y=.5cm, font=\scriptsize, baseline=(base)]
		\node[rotate=-15] (ar) {$\nearrow$};
		\coordinate[below=3pt] (base) at (ar);
		\node[above right=-2pt and 1pt of ar.west] (f) {\indexcoclscale{$#1$}};
	\end{tikzpicture}
}

\newcommand{\othis}[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=1pt] (char) {\tiny #1};}}
\newcommand{\bang}{\,\mathbin{!}\,}
\newcommand{\obang}{\mathbin{\othis{!}}}

\newcommand{\qand}{\quad\text{and}\quad}
\newcommand{\qqand}{\qquad\text{and}\qquad}
\newcommand{\qor}{\quad\text{or}\quad}
\newcommand{\qqor}{\qquad\text{or}\qquad}


\newcommand{\coto}{\nrightarrow}
\newcommand{\cofun}{{\raisebox{2pt}{\resizebox{2.5pt}{2.5pt}{$\setminus$}}}}

\newcommand{\coalg}{\tn{-}\Cat{Coalg}}

\newcommand{\bic}[2]{{}_{#1}\Cat{Comod}_{#2}}

% ---- Changeable document parameters ---- %

\linespread{1.1}
\allowdisplaybreaks
\setsecnumdepth{section}
\settocdepth{section}
\setlength{\parindent}{15pt}
\setcounter{tocdepth}{1}



%--------------- Document ---------------%
\begin{document}

\title{A summary of categorical structures in $\poly$}

\author{David I. Spivak}

%\date{Last updated: \today}

\maketitle

\begin{abstract}
In this document, we collect a list of categorical structures on the category $\poly$ of polynomial functors. There is no implied claim that this list is in any way complete. It includes: ten monoidal structures, eight of which are symmetric, two of which are closed, several of which distribute, several of which interact duoidally; it also includes a right-coclosure and two indexed left coclosures; it also includes various adjunctions of which $\poly$ is a part, including the free monad and cofree comonad and their interaction with various monoidal structures. 
\end{abstract}


\tableofcontents*
\bigskip

This document is only meant as a handy guide to the abundance of structure in $\poly$. In particular, we do not supply proofs, though we have written about most of these structures elsewhere; see \cite{spivak2022poly}, \cite{spivak2021functorial}, and \cite{spivak2022polynomial}. For everything else written here, one can consider it to be only conjecture, since in some cases we have not checked all the details. Hence, if someone proves something written here---something which has not been proven elsewhere---that person should be taken to have the professional ``priority'' and credit. In particular, we wish to claim no credit for originality of anything contained in this document, though most of it was discovered independently by the author, so we also do not supply additional references. We also make absolutely no claim of completeness.

\chapter{Background and notation}

A polynomial functor $p\colon\smset\to\smset$ is any functor that's isomorphic to a coproduct of representables
\[
p\coloneqq\sum_{I: p(1)}\yon^{p[I]}.
\]
We will typically use the above notation---which we call \emph{standard form}---appropriately modified for $p'$, $q$, etc., e.g.
\[
p'\coloneqq\sum_{I': p'(1)}\yon^{p'[I']}
\qqor
q\coloneqq\sum_{J: q(1)}\yon^{q[J]}.
\]

We refer to elements of $p(1)$ as \emph{positions} of $p$ and, for each $I: p(1)$, we refer to the elements of $p[I]$ as \emph{directions} at $I$. A morphism between polynomials is a natural transformation $\varphi\colon p\to q$; by the Yoneda lemma and universal property of coproducts, it consists of a function $\varphi_1\colon p(1)\to q(1)$ and, for each $I: p(1)$ a function $\varphi^\sharp_I\colon q[\varphi_1(I)]\to p[I]$. A map $\varphi$ is called \emph{vertical} if $\varphi_1$ is identity on positions; it is called \emph{cartesian} if for each $I: p(1)$ the function $\varphi_I^\sharp$ is a bijection; see \cref{chap.bifib} for more on this. 

The category of polynomial functors and morphisms between them is denoted $\poly$; the wide subcategory of polynomial functors and cartesian morphisms between them is denoted $\polycart$. The forgetful functor $\poly\to\Cat{Fun}(\smset,\smset)$ preserves limits and coproducts. The forgetful functor $\polycart\to\Cat{Fun}(\smset,\smset)$ preserves all limits and colimits.
%For more, see \cref{chap.background}. 


%-------- Chapter --------%
\chapter{Coproducts and distributive monoidal structures}

The category $\poly$ has coproducts, given by the following formula:
\begin{equation}
p+q\coloneqq\sum_{I: p(1)}\yon^{p[I]}+\sum_{J: q(1)}\yon^{q[J]}
\end{equation}
If one wants the formula to be in standard form, use case logic in the exponent:
\begin{equation}
p+q\cong\sum_{X: p(1)+q(1)}\yon^{\fontsize{8pt}{8pt}\selectfont
	\begin{cases}
  	p[X]&\tn{ if }X\in p(1)\\
  	q[X]&\tn{ if }X\in q(1)
	\end{cases}\normalsize
	}
\end{equation}

For any symmetric monoidal product $(I,\cdot)$ on $\smset$, there is a corresponding symmetric monoidal structure $(\yon^I,\odot)$ on $\poly$, where the monoidal product given as follows:%
\footnote{The symmetric monoidal structure $\odot$ on $\poly$ is the Day convolution of the $\cdot$ structure on $\smset$.}
\begin{equation}
p\odot q\coloneqq\sum_{(I,J): p(1)\times q(1)}\yon^{p[I]\cdot q[J]}.
\end{equation}
It always distributes over $+$:
\begin{equation}
p\odot(q_1+q_2)\cong (p\odot q_1)+(p\odot q_2).
\end{equation}

For any set $S$, there is a monoidal structure $(0,\vee_S)$ on $\smset$,\footnote{I learned the $\vee_1$ monoidal structure (pronounced ``or'') on $\smset$ from Richard Garner, and Solomon Bothwell later informed me that it's called \href{https://hackage.haskell.org/package/these}{\texttt{These}} in Haskell. I learned the $\vee_S$ for $S\geq 2$, as well as other monoidal structures, from \href{https://mathoverflow.net/questions/155939/what-other-monoidal-structures-exist-on-the-category-of-sets}{mathoverflow}.}
 where
\begin{equation}
	A\vee_SB\coloneqq A+A\times S\times B + B.
\end{equation}
We denote the $S=1$ case simply by $\vee\coloneqq\vee_1$. When $S=0$ this is the usual coproduct, $A\vee_0B\cong A+B$, which we will treat seperately since it is very important. The other important monoidal product on $\smset$ for us is $\times$%
\footnote{
	We sometimes denote products using juxtaposition, $AB\coloneqq A\times B$. We may also do this for polynomials $pq\coloneqq p\times q$.
}%
.
%, and the following
%\begin{equation}
%	A!B\coloneqq
%	\begin{cases}
%		A&\tn{ if }B=0\\
%		B&\tn{ if }A=0\\
%		1&\tn{ if }1\leq AB
%  \end{cases}
%\end{equation}
%which has unit $1$. 
These lead to the following symmetric monoidal products on $\poly$:
\begin{align}
\label{eqn.times}
	p\times q&\coloneqq\sum_{(I,J): p(1)\times q(1)}\yon^{p[I]+ q[J]}\\
\label{eqn.otimes}
	p\otimes q&\coloneqq\sum_{(I,J): p(1)\times q(1)}\yon^{p[I]\times q[J]}\\
\label{eqn.ovee}
	p\ovee_S q&\coloneqq\sum_{(I,J): p(1)\times q(1)}\yon^{p[I]\vee_S q[J]}
%\\
%\label{eqn.obang}
%	p\obang q&\coloneqq\sum_{(I,J): p(1)\times q(1)}\yon^{p[I]\bang p[J]}
\end{align}
The first two are highly relevant: the first ($\times$) is the categorical product, and the second ($\otimes$) is the \emph{Dirichlet} product, both of which come up often in practice. Writing $\ovee\coloneqq\ovee_1$, note that there is a pullback square in $\poly$:
\begin{equation}
\begin{tikzcd}
	p\ovee q\ar[r]\ar[d]&
	p\times q\ar[d]\\
	p\otimes q\ar[r]&
	p(1)\times q(1)\ar[ul, phantom, very near end, "\lrcorner"]
\end{tikzcd}
\end{equation}

The dirichlet product commutes with connected limits in either variable: for any connected category $\cat{J}$, functor $p\colon\cat{J}\to\poly$, and polynomial $q$, the induced map
\begin{equation}
	\left(\lim_{j:\cat{J}}p_j\right)\otimes q
	\To{\cong}
	\lim_{j:\cat{J}}(p_j\otimes q)
\end{equation}
is an isomorphism. It commutes with all colimits in either variable: for any category $\cat{J}$, functor $p\colon\cat{J}\to\poly$, and polynomial $q$, the induced map
\begin{equation}
	\colim_{j:\cat{J}}(p_j\otimes q)
	\To{\cong}
	\left(\colim_{j:\cat{J}}p_j\right)\otimes q
\end{equation}
is an isomorphism.

The $\otimes$ and $\times$ operation together form a linearly distributive category,%
\footnote{This fact \eqref{eqn.shapiro_0}, along with \cref{eqn.shapiro_1,eqn.shapiro_2}, were discovered either by or in conjunction with Brandon Shapiro.}
\begin{equation}\label{eqn.shapiro_0}
p\times(q\otimes r)\to (p\times q)\otimes r.
\end{equation}

%-------- Chapter --------%
\chapter{Substitution product}

There is a nonsymmetric monoidal structure on $\poly$ given by composing polynomials. Its unit is $\yon$ and its monoidal product is given by the following formula:
\begin{equation}
p\tri q\coloneqq\sum_{I: p(1)}\sum_{J\colon p[I]\to q(1)}\yon^{\sum\limits_{i: p[I]}q[Ji]}
\end{equation}
If $p\to p'$ and $q\to q'$ are cartesian, then so is $p\tri q\to p'\tri q'$. If $q\to q'$ is vertical, then so is $p\tri q\to p\tri q'$.

The monoidal structure $\tri$ is left distributive with respect to $+$ and $\times$:
\begin{align}
	0\tri q&\cong 0&&(p+p')\tri q\cong (p\tri q)+(p'\tri q)\label{eqn.comp_plus}\\
	1\tri q&\cong 1&&(p\times p')\tri q\cong (p\tri q)\times(p'\tri q)\label{eqn.comp_times}
\end{align}
In fact, $\tri$ preserves all limits in the left-variable, and it preserves connected limits in the right variable. If $p$ is finitary (each $p[I]$ is a finite set) then for any sifted (e.g.\ filtered) category $\cat{J}$ and diagram $q\colon \cat{J}\to\poly$, the natural map
\begin{equation}\label{eqn.finitary_tri_sifted}
  \colim_{j: \cat{J}}(p\tri q_j)
  \To{\cong}
	p\tri\colim_{j: \cat{J}}q_j
\end{equation}
is an isomorphism. For any category $\cat{I}$, diagram $p\colon \cat{I}\to\polycart$ of cartesian maps, and polynomial $q:\poly$, the natural map
\begin{equation}\label{eqn.cart_tri}
	\colim_{i: \cat{I}}(p_i\tri q)
	\To{\cong}
	(\colim_{i: \cat{I}}p_i)\tri q
\end{equation}
is an isomorphism. For any $p:\poly$ the operation $(p\tri -)$ preserves monomorphisms and epimorphisms in $\poly$. For any $q:\poly$, the operation $(-\tri q)$ preserves monomorphisms and if $q\neq 0$ then it also preserves epimorphisms.%
\footnote{The unique map $\yon\to 1 $ is an epimorphism, but $\yon\tri 0\to 1\tri 0$ is not.}

The monoidal structure $\tri$ is normal duoidal with $\otimes$, i.e.\ they have the same unit, $\yon$, and there is a natural transformation
\begin{equation}\label{duoidal}
	(p_1\tri p_2)\otimes(q_1\tri q_2)\too(p_1\otimes q_1)\tri(p_2\otimes q_2)
\end{equation}
satisfying the usual laws. Using $\yon$ in place of $p_1$, $p_2$, $q_1$, or $q_2$, \eqref{duoidal} induces natural maps
\begin{equation}
	[p,q]\to[r\tri p, r\tri q]
	\qqand
	[p,q]\to[p\tri r, q\tri r]
\end{equation}
and
\begin{equation}
	r\tri[p,q]\to[p,r\tri q]
	\qqand
	[p,q]\tri r\to [p,q\tri r].
\end{equation}
The identity functor $\poly\to\poly$ is lax monoidal as a functor $(\poly,\yon,\tri)\to(\poly,\yon,\otimes)$, i.e.\ for every $p,q$ a map of polynomials
\begin{equation}\label{eqn.indep}
	p\otimes q\to p\tri q
\end{equation}
satisfying the usual laws. This map is derived from \eqref{duoidal} by taking $p_1\coloneqq p$, $q_1\coloneqq\yon$, $p_2\coloneqq\yon$, and $q_2\coloneqq q$. Note that if $p$ is linear or $q$ is representable, then \eqref{eqn.indep} is an isomorphism:
\begin{equation}
  A\yon\otimes q\cong A\yon\tri q
  \qqand
  p\otimes\yon^A\cong p\tri \yon^A.
\end{equation}


There are surprising natural maps that combine the four main monoidal products: $\tri$, $\otimes$, $\times$, and $+$:
\begin{equation}\label{eqn.allfour}
	(p_1\tri p_2\tri p_3)\times(q_1\tri q_2\tri q_3)\to (p_1\otimes q_1)\tri (p_2\times q_2)\tri(p_3+q_3)
\end{equation}
%These commute with the duoidality maps \eqref{duoidal}.
%These lead to interesting maps, e.g.\ $pq\to p\tri (q\yon)$ and $p(1)q\to p\tri q$.
%Together these assemble into maps that sandwich a single $\times$ between arbitrary-length layers of $\otimes$'s and $+$'s, i.e.\ of the following form for any $i,j:\nn$ and $2(i+1+j)$-many polynomials denoted $\myred{p_{-i}},\myred{q_{-i}}\ldots,\myred{p_{-1}},\myred{q_{-1}},p_0,\mygreen{q_0}
%,\mygreen{p_1},\mygreen{q_1},\ldots,\mygreen{p_j},\mygreen{q_j}:\poly$,
%\begin{multline}
%	(\myred{p_{-i}}\tri\cdots\tri \myred{p_{-1}}\tri p_0\tri \mygreen{p_1}\tri\cdots\tri \mygreen{p_j})
%	\times
%	(\myred{q_{-i}}\tri\cdots\tri \myred{q_{-1}}\tri q_0\tri \mygreen{q_1}\tri\cdots\tri \mygreen{q_j})
%	\to\\
%	(\myred{p_{-i}}\otimes \myred{q_{-i}})\tri\cdots\tri(\myred{p_{-1}}\otimes \myred{q_{-1}})\tri(p_0\times q_0)\tri(\mygreen{p_1}+\mygreen{q_1})\tri\cdots\tri(\mygreen{p_j}+\mygreen{q_j})
%\end{multline}

There are other interesting aspects of the substitution product $\tri$. In particular, monoids with respect to $\tri$ generalize $\Sigma$-free operads. Comonoids with respect to $\tri$ are exactly categories. Bicomodules with respect to $\tri$ are parametric right adjoints between copresheaf categories.

\chapter{Monoidal closures}

There are closures for $\times$, $\otimes$, and $\ovee_S$ for each $S:\smset$ (\cref{eqn.times,eqn.otimes,eqn.ovee}),%
given by
\begin{align}
  q^p&\coloneqq \prod_{I: p(1)}q\tri(p[I]+\yon)\label{eqn.cart_cl}\\
  [p,q]&\coloneqq\prod_{I: p(1)}q\tri(p[I]\times\yon)\\
  \present{p,q}_S&\coloneqq\prod_{I: p(1)}q\tri(p[I]+p[I]\times S\yon+\yon)
\end{align}
These satisfy the defining universal properties:
\begin{align}
  \poly(p',q^p)&\cong\poly(p'\times p,q)\\
  \poly(p',[p,q])&\cong\poly(p'\otimes p,q)\\
  \poly(p',\present{p,q}_S)&\cong\poly(p'\ovee_S p,q)
\end{align}
The first one, $q^p$, is the Cartesian closure; its standard form is not particularly enlightening, and neither is that of the third one, $\present{p,q}$. The second one, $[p,q]$, is what we call the \emph{Dirichlet closure}; it has a very nice standard form:
\[
[p,q]\cong\sum_{\varphi:\poly(p,q)}\yon^{\sum\limits_{I: p(1)}q[\varphi_1I]}
\]
where $\varphi_1\colon p(1)\to q(1)$ is the $1$-component of the natural transformation $\varphi$. Another nice representation is
\begin{equation}
[p,q]\cong\prod_{I: p(1)}\sum_{J: q(1)}\prod_{j: q[J]}\sum_{i: p[I]}\yon
\end{equation}

The cartesian closure satisfies all the usual arithmetic properties:
\begin{gather}
	q^0\cong1,\quad
	q^{p_1+p_2}\cong (q^{p_1})\times(q^{p_2}),\quad
	1^p\cong 1,\quad
	(q_1\times q_2)^p\cong q_1^p\times q_2^p,\quad
	q^1\cong q,\quad
	q^{p_1\times p_2}\cong (q^{p_2})^{p_1}
\end{gather}
The Dirichlet closure has only some of the analogous properties:
\begin{gather}
	[0,p]\cong1,\qquad
	[p_1+p_2,q]\cong [p_1,q]\times[p_2,q],\qquad
	[\yon,q]\cong q,\qquad
	[p_1\otimes p_2,q]\cong[p_1,[p_2,q]]
\end{gather}
The Dirichlet closure also satisfies the following relation with $(1,\times)$:
\begin{equation}
  [p,1]\cong 1
  \qqand
  [p,q_1\times q_2]\cong[p,q_1]\times[p,q_2].
\end{equation}
The following pattern holds for any monoidal closure, but we include it for $\times$ and $\otimes$ in case it's convenient:
\begin{equation}
	q_1^{p_1}\times q_2^{p_2}\to (q_1q_2)^{p_1p_2}
	\qqand
	[p_1,q_1]\otimes[p_2,q_2]\to[p_1\otimes p_2,q_1\otimes q_2]
\end{equation}

The cartesian closure also interacts with substitution as follows:
\begin{equation}
	r\tri (q^p)\to (r\tri q)^p
\end{equation}
and this map is an isomorphism in case $p\cong\yon^A$ for some $A:\smset$. 
%The diagonal $p\to p\times p$ induces a map
%\begin{equation}
%	q^p\to (pq)^p
%\end{equation}
The representation functor $\yon^-\colon(\poly,1,\times)\op\to(\poly,\yon,\tri)$ is strong monoidal
\begin{equation}
	\yon\cong\yon
	\qqand
	\yon^p\tri\yon^q\cong\yon^{p\times q}.
\end{equation}

The cartesian closure interacts with coproducts and products via maps
\begin{equation}
  q^p\to(q+r)^{p+r}
  \qqand
	q^p\to(qr)^{pr},
\end{equation}
natural in $p:\poly\op$, $q:\poly$, and dinatural in $r$.

Because of duoidality \eqref{duoidal}, $\otimes$-closure interacts with substitution:
\begin{equation}\label{eqn.shapiro_1}
	\yon\cong[\yon,\yon]
	\qqand
	[p_1,q_1]\tri[p_2,q_2]\to [p_1\tri p_2,q_1\tri q_2].
\end{equation}


Dirichlet-mapping into $\yon$ is often of interest; we have the following maps and isomorphisms:
\begin{align}
	[\yon,\yon]&\cong\yon\\
  [p,\yon]\times[q,\yon]&\cong[p+q,\yon]\\
  \yon^A&\cong[A\yon,\yon]\\
  [p,\yon]+[q,\yon]&\to[pq,\yon]\\
  A\yon&\cong[\yon^A,\yon]\\
	[p,\yon]\otimes[q,\yon]&\to[p\otimes q,\yon]\\
	[p,\yon]\tri[q,\yon]&\to[p\tri q,\yon]
\end{align}


%-------- Chapter --------%
\chapter{Coclosures for substitution and Dirichlet product}

The left Kan extension of a polynomial functor $p$ along another polynomial functor $q$ is again a polynomial functor, which we denote
\begin{equation}
\lens{p}{q}\coloneqq\sum_{I: p(1)}\yon^{q\tri\; (p[I])}
\end{equation}
This satisfies the following universal property of a Kan extension, i.e.\ a right-coclosure:%
\footnote{I learned the right-coclosure from Josh Meyers. I learned the in-retrospect-obvious fact that it is the same as a left Kan extension from Todd Trimble.}
\begin{equation}
	\poly\left(\lens{p}{q},p'\right)\cong\poly\left(p,p'\tri q\right).
\end{equation}
The coclosure $\lens{p}{q}$ is covariant in $p$ and contravariant in $q$:
\begin{equation}
  \begin{prooftree}
  	\Hypo{p\to p'}
  	\Hypo{q\from q'}
    \Infer2{\lens{p}{q}\to\lens{p'}{q'}}
  \end{prooftree}
\end{equation}
and if $p\to p'$ is vertical or cartesian, then so is $\lens{p}{q}\to\lens{p'}{q}$, respectively. 

Just like evaluation is the most common use of a closure, co-evaluation is the most common use of this coclosure: for any $p,q:\poly$ one has
\begin{equation}
p\to\lens{p}{q}\tri q
\end{equation}

Since $\lens{-}{q}$ is a left adjoint, it interacts with $+$ by
\begin{equation}
	\lens{0}{q}=0
	\qqand
	\lens{p+p'}{q}\cong\lens{p}{q}+\lens{p'}{q}.
\end{equation}

The coclosure interacts with $\tri$ by
\begin{equation}
	\lens{\lens{p}{q}}{q'}\cong\lens{p}{q'\tri q}
	\qqand
	p\cong\lens{p}{\yon}
\end{equation}
\begin{equation}
	\lens{p\tri p'}{q}\to p\tri\lens{p'}{q}
\end{equation}


The coclosure interacts with $\otimes$ via vertical maps
\begin{equation}
	\lens{\yon}{\yon}\cong\yon
	\qqand
	\lens{p_1\otimes p_2}{q_1\otimes q_2}\to\lens{p_1}{q_1}\otimes\lens{p_2}{q_2}
\end{equation}
It interacts with the $\otimes$-closure (Dirichlet-hom) by a vertical map
\begin{equation}
	\left[\lens{p}{q},p'\right]\to[p,p'\tri q]
\end{equation}
and a map
\begin{equation}\label{eqn.shapiro_2}
	\lens{p\otimes p'}{q}\to\lens{p}{[p',q]}.
\end{equation}

For any set $A$, we have $\lens{p}{\yon+A}\cong p\times\yon^A$ by \eqref{eqn.cart_cl}. More importantly we have
\begin{equation}\label{eqn.left_adjoints}
  \lens{p}{A\yon}\cong 
  p\tri\yon^A\cong 
  p\otimes\yon^A
  \qqand
  A\yon\otimes\lens{p}{q}\cong
  A\yon\tri\lens{p}{q}\cong
	\lens{A\yon\tri p}{q}
\end{equation}
\cref{eqn.left_adjoints} generalize to bicomodules---namely $A\yon$ and $\yon^A$ can be replaced by any pair of left and right adjoint bicomodules---even though that is beyond the scope of this document. Indeed, quite a few of the structures in this document generalize to the bicomodule setting.

For any polynomial monad $(m,\eta,\mu)$, the corresponding Lawvere theory is the $\tri$-comonad (category)
\begin{equation}
	\text{Law}(m)\cong\lens{u}{u\tri m}
\end{equation}
where $u\coloneqq\sum_{N:\nn}\yon^N$. In other words, $\lens{u}{u\tri m}$ is a compact representation of what usually has a long description: ``the full subcategory of (the opposite of (the Kleisli category for $m$ on $\smset$)), spanned by the finite sets.''

There is also an \emph{indexed} left $\tri$-coclosure. That is, for any function $f\colon p(1)\to q(1)$, define
\begin{equation}
	p\cocl{f}q\coloneqq \sum_{I: p(1)}q[fI]\,\yon^{p[I]}.
\end{equation}
This satisfies the following indexed-adjunction formula:%
\footnote{Note that the indexed adjunction \eqref{indexed_adjunction} is not natural in $q:\poly$, but it is natural in $q:\polycart$.}
\begin{equation}\label{indexed_adjunction}
	\poly(p,q\tri r)\cong\sum_{f\colon p(1)\to q(1)}\poly(p\cocl{f}q,r)
\end{equation}

Given $\varphi\colon p\to q\tri r$, we denote its image by $(\varphi.1,\varphi.2)$, where $\varphi.1\colon p(1)\to q(1)$ and $\varphi.2\colon (p\cocl{\varphi.1}q)\to r$. The indexed coclosure is a very well-behaved structure.
\begin{align}
	p\cocl{!}\yon^A&\cong Ap\\
	p\cocl{\id}p&\cong p_*\label{eqn.deriv}\\
	(p+p')\cocl{(f,f')}q&\cong(p\cocl{f}q)+(p'\cocl{f'}q)\\
	p\cocl{(f,g)}(q\times q')&\cong(p\cocl{f}q)+(p\cocl{g}q')\\
	(p\cocl{f}q)\times p'&\cong(p\times p')\cocl{(p\times!)\then f}q\\
	(p\cocl{f}q)\tri p'&\cong(p\tri p')\cocl{(p\tri!)\then f}q\\
	p\cocl{f}(q\tri r)&\cong(p\cocl{f.1}q)\cocl{f.2}r\\
	(p\otimes p')\cocl{f\otimes f'}(q\otimes q')&\cong(p\cocl{f}q)\otimes(p'\cocl{f'}q')\\
	[p,q\tri r]&\cong\sum_{f\colon p(1)\to q(1)}[p\cocl{f}q,r]
\end{align}
In \eqref{eqn.deriv}, $p_*$ is defined as follows.
\begin{equation}\label{eqn.p_star}
p_*\coloneqq \dot{p}\yon=p\cocl{\id}p=\sum_{I: p(1)}p[I]\yon^{p[I]}
\end{equation}
Though it can be defined in terms of the derivative $\dot{p}$ of $p$, we find $p_*$ to be a much more fundamental construction than the derivative. For example, the bundle representation of a polynomial $p$ is $p_*(1)\to p(1)$. The operation $p\mapsto p_*$ is a comonad on $\poly$, i.e.\ $p_*\to p$ and $p_*\to (p_*)_*$, and each $p_*$ has the structure of a comonad, i.e.\ $p_*\to\yon$ and $p_*\to p_*\tri p_*$. 

Given a map $\varphi\colon p\to p'$ and a function $g\colon q(1)\to q'(1)$, there is a Cartesian map
\begin{equation}
	(p\cocl{\varphi\tri1}p')\tri(q\cocl{g}q')\to
	(p\tri q)\cocl{\varphi\tri g}(p'\tri q'),
\end{equation}
natural in $p,q:\poly$ and $p',q':\polycart$. In particular, there is a Cartesian map
\begin{equation}
	p_*\tri q_*\to(p\tri q)_*.
\end{equation}



Returning to $p\mapsto p_*$, it is not functorial in $\poly$, but it is functorial in the Cartesian morphisms $\polycart$. It is also functorial as a map $\poly\to\Span(\poly)$:
\begin{align}
	\cocl{}\colon\poly&\to\Span(\poly)\\
	p&\mapsto p_*\\
	(p\To{\varphi}q)&\mapsto\big( p_*\from(p\cocl{\varphi_1}q)\to q_*\big)
\end{align}\goodbreak
That is, for any $p\To{\varphi}q\To{\psi}r$, there is an isomorphism
\begin{equation}
	(p\cocl{\varphi_1}q)\times_{ q_*}(q\cocl{\psi_1}r)\cong p\cocl{(\varphi\then\psi)_1}r
\end{equation}
This functor is strong monoidal with respect to both $+$ and $\otimes$. One may think of it as representing the bundle view of $\poly$. Indeed, for any $p:\poly$ we have a counit map $\epsilon_p\colon p_*\to p$, and given $\varphi\colon p\to q$, there is an induced span
\begin{equation}
\begin{tikzcd}
	 p_*\ar[d]&p\cocl{\varphi_1}q\ar[d]\ar[l]\ar[r]& q_*\ar[d]\\
	p\ar[r, equal]&p\ar[r,"\varphi"']&q
\end{tikzcd}
\end{equation}
and evaluating at $1$ returns the usual bundle picture, since $(p\cocl{\varphi_1}q)(1)\cong p(1)\times_{q(1)}q_*(1)$.

There is an indexed coclosure for $\otimes$.%
\footnote{I learned about this indexed coclosure $\hyper{}$ for $\otimes$ from Nelson Niu.}
For any function $f\colon p(1)\to q(1)$, define
\begin{equation}
p \hyper{f} q\coloneqq\sum_{I: p(1)}\yon^{\left(p[I]^{q[fI]}\right)}
\end{equation}
This satisfies the following indexed-adjunction formula:
\begin{equation}
	\poly(p,q\otimes r)\cong\sum_{f\colon p(1)\to q(1)}\poly(p\hyper{f}q,r)
\end{equation}
It also satisfies the following:
\begin{align}
	(p_1+p_2)\hyper{(f_1,f_2)}q&\cong(p_1\hyper{f_1}q)+(p_2\hyper{f_2}q)\\
	p\hyper{(f_1,f_2)}(q_1\otimes q_2)&\cong (p\hyper{f_1}q_1)\hyper{f_2}q_2
\end{align}
and for any $f\colon p(1)\to (q_1\tri q_2)(1)$, there is a natural map coming from duoidality \eqref{duoidal}:
\begin{equation}
	(p\cocl{f_1}q_1)\hyper{f_2}q_2\to
	p\hyper{f}(q_1\tri q_2).
\end{equation}
For any $f\colon p(1)\to p'(1)$ there is a natural map
\begin{equation}
\lens{p}{q\tri p'}\to\lens{p\hyper{f}p'}{q}.
\end{equation}

For any polynomial $p$, let $\lin{p}\coloneqq p(1)\yon$. For any $p,q:\poly$ there is an isomorphism
\begin{equation}
	p\cocl{}\left(\lens{\lin{p}}{q}\hyper{}p\right)\cong p\tri\lin{q}
\end{equation}
where the unwritten indices of $\cocl{}$ and $\hyper{}$ are both the identity on $p(1)$.

For any $q:\poly$ and $A:\smset$, let $q\coalg[A]:\smset$ denote the set $\smset(A,q(A))$ of $q$-coalgebra structures on $A$. For a polynomial $p$, let $q\coalg_p\coloneqq\sum_{I:p(1)}\yon^{q\coalg[p[I]]}$. Then there is an isomorphism
\begin{equation}
	q\coalg_p
	\cong
	\lens{p}{q}\hyper{}p
\end{equation}
where the unwritten index of $\hyper{}$ is the identity on $p(1)$.


%-------- Chapter --------%
\chapter{Other monoidal structures}

Of the following three monoidal structures, only the first one ($\curlyvee$) appears to be interesting; it will appear prominently in \cref{chap.adj_mon_com}.

There is a symmetric monoidal structure on $\poly$ with unit $0$ and product given by
\begin{equation}\label{eqn.vee}
  p\curlyvee q\coloneqq p+(p\otimes q)+q.
\end{equation}
The functor $(p\mapsto p+\yon)$ is strong monoidal $(\poly,0,\curlyvee)\to(\poly,\yon,\otimes)$, i.e.\ there is a natural isomorphism
\begin{equation}
	(p+\yon)\otimes(q+\yon)\cong (p\curlyvee q)+\yon.
\end{equation}
The identity functor $\poly\to\poly$ has a lax monoidal structure,
\begin{equation}
	p+q\to p\curlyvee q.
\end{equation}
There are two duoidal structures for $\curlyvee$, one with $\tri$ and one with $\otimes$:
\begin{align*}
	(p_1\tri p_2)\curlyvee(q_1\tri q_2)&\to(p_1\curlyvee q_1)\tri(p_2\curlyvee q_2)\\
	(p_1\otimes p_2)\curlyvee(q_1\otimes q_2)&\to(p_1\curlyvee q_1)\otimes(p_2\curlyvee q_2)
\end{align*}
We will see in \cref{eqn.vee1,eqn.vee2,eqn.vee3,eqn.vee4} that $\curlyvee$ is surprisingly useful when it comes to free monads.

Here are two other symmetric monoidal structures, though we currently know of no interesting uses of them, so we do not even give them symbols. We are simply using the fact that if a symmetric monoidal product distributes over $+$ then we can follow the pattern we learned from Garner; see \eqref{eqn.ovee}.
\begin{align}
	(p,q)&\mapsto p+(p\times q)+q\\
	(p,q)&\mapsto p+(p\ovee q)+q
\end{align}
Their units are both $0$. 

We know of two more monoidal products $(\yon,\dagger)$ and $(\yon, \ddagger)$ from Nelson Niu, who cites de Paiva's notion of \emph{cross product} as inspiration for $\dagger$:
\begin{align}
	p\dagger q\coloneqq\sum_{I: p(1)}\sum_{J: q(1)}\prod_{i: p[I]}\prod_{j\colon p(1)\to q[J]}\yon\\
	p\ddagger q\coloneqq\sum_{I: p(1)}\sum_{J: q(1)}\prod_{i\colon q(1)\to p[I]}\prod_{j\colon p(1)\to q[J]}\yon
\end{align}
E.g.\ in the case of monomials we have $I\yon^A\dagger J\yon^B\cong IJ\yon^{AB^I}$ and $I\yon^A\ddagger J\yon^B\cong IJ\yon^{A^JB^I}$.



%-------- Chapter --------%
\chapter{Adjunctions, monads, and comonads on $\poly$}\label{chap.adj_mon_com}

There are adjunctions between $\poly$ and $\smset$ and between $\poly$ and $\smset\op$, each labeled by where they send $p:\poly$ and $A:\smset$:
\begin{equation}\label{eqn.adjunctions}
\begin{tikzcd}[column sep=60pt]
  \poly
  	\ar[from=r, shift left=8pt, "A" description]
		\ar[from=r, shift left=-24pt, "A\yon"']&
  \smset
  	\ar[from=l, shift right=24pt, "p(0)"']
  	\ar[from=l, shift right=-8pt, "p(1)" description]
	\ar[from=l, phantom, "\scriptstyle\bot"]
	\ar[from=l, phantom, shift left=16pt, "\scriptstyle\bot"]
	\ar[from=l, phantom, shift right=16pt, "\scriptstyle\bot"]
\end{tikzcd}
\hspace{1in}
\begin{tikzcd}[column sep=60pt]
	\poly
  	\ar[from=r, shift left=8pt, "\yon^A"]
		\ar[from=r, phantom, "\scriptstyle\bot"]
  	&
	\smset\op
		\ar[from=l, shift right=-8pt, "\Gamma(p)"]
\end{tikzcd}
\end{equation}
We write $A$ to denote $A\yon^0$. All the leftward maps in \eqref{eqn.adjunctions} are fully faithful, and all the rightward maps are essentially surjective. The leftward maps from $\smset$ are also rig monoidal (i.e.\ strong monoidal with respect to $+$ and $\otimes$):
\begin{align}
	A\yon+B\yon&\cong(A+B)\yon&
	A\yon\otimes B\yon&\cong(A\times B)\yon\\
	A\yon^0+B\yon^0&\cong(A+B)\yon^0&
	A\yon^0\otimes B\yon^0&\cong(A\times B)\yon^0
\end{align}
The rightward maps to $\smset$ are also distributive monoidal; indeed by \cref{eqn.comp_plus,eqn.comp_times}, the following hold for any $A:\smset$, in particular for $A:\{0,1\}$.
\begin{equation}
	p(A)+q(A)\cong(p+q)(A)
	\qqand
	p(A)\times q(A)\cong(p\times q)(A)
\end{equation}
We denote the idempotent comonad $p\mapsto p(1)\yon$ by $\lin{p}$. It is strong monoidal with respect to $+,\otimes$ and lax monoidal with respect to $\tri$. 

The functor $\Gamma$ preserves coproducts, since coproducts in $\smset\op$ are products in $\smset$:
\begin{equation}
	\Gamma(p+q)\cong\Gamma(p)\times\Gamma(q)
\end{equation}

We can say more about $\Gamma$ if we package it with $p\mapsto p(1)$; i.e.\ there is an adjunction
\begin{equation}\label{eqn.rectangle}
\begin{tikzcd}[column sep=60pt]
	\poly
  	\ar[from=r, shift left=8pt, "B\yon^A"]
		\ar[from=r, phantom, "\scriptstyle\bot"]
  	&
	\smset\times\smset\op
		\ar[from=l, shift right=-8pt, "{\big(p(1)\,,\,\Gamma(p)\big)}"]
\end{tikzcd}
\end{equation}
This functor is comonadic. It is also strong monoidal with respect to coproduct and $\otimes$. To say so requires us to mention that $\smset\times\smset\op$ has a coproduct structure and to specify an $\otimes$ structure on $\smset\times\smset\op$; they are given as follows:
\begin{align}
 (A_1,B_1)+(A_2,B_2)&\coloneqq(A_1+A_2\,,\,B_1\times B_2)\\
  (A_1,B_1)\otimes(A_2,B_2)&\coloneqq(A_1\times A_2\,,\,B_1^{A_2}\times B_2^{A_1})
\end{align}
Returning to our point, the left adjoint in \eqref{eqn.rectangle} is rig monoidal (preserves $+$ and $\otimes$):
\begin{align}
	(p(1),\Gamma(p))+(q(1),\Gamma(q))&\cong((p+q)(1),\Gamma(p+q))\\
	(p(1),\Gamma(p))\otimes(q(1),\Gamma(q))&\cong((p\otimes q)(1),\Gamma(p\otimes q))
\end{align}

The map $p\mapsto p_*$ from \cref{eqn.p_star} forms an idempotent comonad on $\polycart$. It is strong monoidal with respect to $\otimes,+$. There is an isomorphism $\lin{p}_*\cong \lin{p}$.
% A quiver can be identified with a pair $(a,\tau)$, where $a:\poly$ and $\tau\colon \lin{a_*}\to a$ are arrows and their targets.

There is a cofree $\tri$-comonoid (often called the free comonad) construction on $\poly$:
\begin{equation}
\begin{tikzcd}[column sep=60pt]
	\Cat{Comon}(\poly)
  	\ar[from=r, shift left=8pt, "\cofree"]
		\ar[from=r, phantom, "\scriptstyle\bot"]
  	&
	\poly
		\ar[from=l, shift right=-8pt, "U"]
\end{tikzcd}
\end{equation}
where $U$ is the forgetful functor that sends a comonoid to its carrier. The cofree comonoid $\cofree_p$ on $p:\poly$ is carried by the limit
\begin{equation}
\cofree_p\coloneqq\lim(\cdots\to p_{n+1}\To{f_n} p_n\to\cdots\to p_1\To{f_0} p_0)
\end{equation}
where the $p_k$ are defined inductively as follows:
\begin{align}
	p_0&\coloneqq\yon&p_{k+1}&\coloneqq (p\tri p_k)\times\yon\\
\intertext{and the maps $f_k\colon p_{k+1}\to p_k$ are defined inductively as follows:}
	p_1=p\times\yon&\To{f_0\coloneqq\tn{proj}}\yon=p_0&p_{k+2}=(p\tri p_{k+1})\times\yon&\To{f_{k+1}\coloneqq(p\tri f_k)\times\yon}(p\tri p_{k})\times\yon=p_{k+1}
\end{align}
The map $\cofree\to\yon$ is easy and the map $\cofree\to\cofree\tri\cofree$ is given by maps $p_{m+n}\to p_m\tri p_n$, which themselves arise by induction on $n$, properties of $\cocl{}$, and maps $p\tri p_m\to p_m\tri p$ that  arise by induction on $m$. There is an isomorphism of polynomials
\begin{equation}\label{eqn.cofree_iso}
	\cofree_p\To{\cong} (p\tri\cofree_p)\times\yon.
\end{equation}
%For any $A:\smset$, we have $\cofree_{A\yon}\cong(A\yon)^\nn$. 
If $p\to q$ is cartesian, so is $\cofree_p\to\cofree_q$.

In many different ways, the cofree comonad functor $\cofree\colon\poly\to\poly$ is lax monoidal as it maps into the $(\yon,\otimes)$ monoidal structure:%
\footnote{Recall from \eqref{eqn.ovee} that $p\ovee q\coloneqq \sum_{(I,J): p(1)\times q(1)}\yon^{p[I]+p[I]\times q[J]+q[J]}$.}
\begin{align}
  \cofree_p\otimes\cofree_q&\to\cofree_{p\times q}\\
  \label{cofree_lax_monoidal}
  \cofree_p\otimes\cofree_q&\to\cofree_{p\otimes q}\\
  \cofree_p\otimes\cofree_q&\to\cofree_{p\tri q}\\
	\cofree_p\otimes\cofree_q&\to\cofree_{p\ovee q}  
\end{align}
It also has natural comonoid homomorphisms of the form
\begin{equation}
	\cofree_{[p,q]}\otimes\cofree_{[p',q']}\to\cofree_{[p+p',q+q']}
\end{equation}
that arise from the counits of any comonoid, as well as the distributivity of $\otimes$ over $+$.

There is a free $\tri$-monoid (often called the free monad) construction on $\poly$
\begin{equation}
\begin{tikzcd}[column sep=60pt]
	\poly
  	\ar[from=r, shift left=8pt, "U"]
		\ar[from=r, phantom, "\scriptstyle\bot"]
  	&
	\Cat{Mon}(\poly)
		\ar[from=l, shift right=-8pt, "\free"]
\end{tikzcd}
\end{equation}
where $U$ is the forgetful functor that sends a monoid to its carrier. We only consider free monads on finitary polynomials $q$, i.e.\ ones for which $q[J]$ is finite for all $J:q(1)$; for the more general story see \href{https://arxiv.org/abs/0906.4931}{Gambino-Kock}. The free $\tri$-monoid on $q$ can be constructed as the colimit:
\begin{equation}
	\free_q\coloneqq\colim(\cdots\from q_{n+1}\From{g_n}q_n\from\cdots\from q_1\From{g_0} q_0)
\end{equation}
where the $q_k$ are defined inductively as follows:
\begin{align}
	q_0&\coloneqq \yon&q_{k+1}&\coloneqq \yon+(q\tri q_k)\\
\intertext{and the maps $g_k\colon q_{k}\to q_{k+1}$ are defined inductively as follows:}
	q_0=\yon&\To{g_0\coloneqq\tn{incl}}\yon+q=q_1&q_{k+1}=\yon+(q\tri q_{k})&\To{g_{k+1}\coloneqq\yon+(q\tri g_k)}\yon+(q\tri q_{k+1})=q_{k+2}
\end{align}


Analogous to \cref{eqn.cofree_iso} there is an isomorphism of polynomials
\begin{equation}
	 \yon+(p\tri\free_p)\To{\cong}\free_p.
	\end{equation}


For any polynomial $p:\poly$ and set $X:\smset$, there is a natural bijection
\begin{equation}
  \free_p\tri X
  \cong
	\free_{p+X}\tri 0  
\end{equation}
and each is isomorphic to the free $p$-algebra on the set $X$.

For any polynomial $p:\poly$ and set $X:\smset$, there is a natural bijection
\begin{equation}
  \free_p\tri X
  \cong
	\free_{p+X}\tri 0  
\end{equation}
and each is isomorphic to the free $p$-algebra on the set $X$.

The free monad monad $\free\colon\poly\to\poly$ is not lax monoidal with respect to $\otimes$ on both sides,%
\footnote{For example, there is no map of polynomials 
$
  \free_1\otimes\free_0\cong\yon+1
  \To{??}
  \yon\cong\free_0\
$.
}
but in many different ways, the free monad functor is lax monoidal as it maps out of the $(0,\curlyvee)$ monoidal structure from \eqref{eqn.vee}:
\begin{align}
\label{eqn.vee1}
	\free_p+\free_q&\to\free_{p\curlyvee q}\\
\label{eqn.vee2}
	\free_p\otimes\free_q&\to\free_{p\curlyvee q}\\
\label{eqn.vee3}
	\free_p\tri\free_q&\to\free_{p\curlyvee q}\\
\label{eqn.vee4}
	\free_p\curlyvee\free_q&\to\free_{p\curlyvee q}
\end{align}

The functor $\free_-\colon\poly\to\poly$ is itself a monad
\begin{equation}
	p\to\free_p
	\qqand
	\free_{\free_p}\to\free_p
\end{equation}
and the functor $\cofree_-\colon\poly\to\poly$ is itself a comonad
\begin{equation}
	\cofree_p\to p
	\qqand
	\cofree_p\to\cofree_{\cofree_p}. 
\end{equation}
Moreover, the former is a module over the latter, i.e.\ for any finitary $p,q$ there is a natural map
\begin{equation}\label{module_easy}
  \free_p\otimes\cofree_q\to\free_{p\otimes q}
\end{equation}
satisfying the action laws for the maps from \cref{cofree_lax_monoidal} as well as coherence for $\free$ as a monad and $\cofree$ as a comonad:
\begin{equation}\label{eqn.monad_comonad_coherence}
\begin{tikzcd}
  p\otimes\cofree_q\ar[r]\ar[d]&p\otimes q\ar[d]\\
  \free_p\otimes\cofree_q\ar[r]&\free_{p\otimes q}
\end{tikzcd}
\hspace{.6in}
\begin{tikzcd}
	\free_{\free_p}\otimes\cofree_q\ar[d]\ar[r]&
	\free_{\free_p}\otimes\cofree_{\cofree_q}\ar[r]&
	\free_{\free_p\otimes\cofree_q}\ar[r]&
	\free_{\free_{p\otimes q}}\ar[d]\\
	\free_p\otimes\cofree_q\ar[rrr]&&&
	\free_{p\otimes q}
\end{tikzcd}
\end{equation}
This induces maps $\free_{[p,\yon]}\to [\cofree_p,\yon]$ and $\cofree_{[p,\yon]}\to[\free_p,\yon]$ and similarly for any monad in place of $\yon$. In particular for $p=\yon^A$ we have an isomorphism
\begin{equation}
	\free_{A\yon}\To{\cong}[\cofree_{\yon^A},\yon]
\end{equation}

%More generally, the functor $\free_{-\curlyvee -}\colon\poly\times\poly\to\poly$ is a module over $\cofree_-$, i.e.\ for any $p,p',q:\poly$ there is a natural map
%\begin{equation}
%  \free_{p\curlyvee p'}\otimes\cofree_q\to\free_{(p\otimes q)\curlyvee p'}
%\end{equation}
%satisfying the action laws and monad-comonad coherence, analogous to \eqref{eqn.monad_comonad_coherence}.

For $p:\poly$ and $A:\smset$ there is a natural map
\begin{equation}
	\cofree_{p\tri A\yon}\to\cofree_p\tri\free_{A\yon}.
\end{equation}

For any polynomial $e:\poly$, exponentiation by $e$ is a monad on $\poly$:
\begin{equation}
	p\to p^e
	\qqand
	(p^e)^e\to p^e
\end{equation}
This monad distributes with the free monad monad
\begin{equation}
	\free_{p^e}\to(\free_p)^e
\end{equation}

For any polynomial monad $t$, exponentiating with base $t$ gives a surprising lax monoidal functor $(\poly,1,\times)\op\to(\poly,\yon,\tri)$:
\begin{equation}
	1\to t^\yon
	\qqand
	t^p\times t^q\to t^{p\tri q}.
\end{equation}
This makes use of the maps \eqref{eqn.allfour}. In particular, for any monad $t$ and comonad (category) $c$, the polynomial $t^c$ has a natural $(\times)$-monoid structure
\begin{equation}
  1\to t^c
  \qqand
  t^c\times t^c\to t^c.
\end{equation}

\chapter{*-Bifibration over $\smset$ and factorization systems}\label{chap.bifib}

The functor
\begin{equation}\label{eqn.bifib}
\big(p\mapsto p(1)\big)\colon\poly\to\smset
\end{equation}
is a *-bifibration. In particular, for any function $f\colon A\to B$, there is an adjoint triple $f_!\dashv f^*\dashv f_*$ :
\begin{equation}
\begin{tikzcd}[column sep=50pt]
	\poly_A
		\ar[r, shift left=16pt, "f_!"]
		\ar[r, shift right=16pt, "f_*"']
		\ar[from=r, "f^*" description]
		\ar[r, phantom, shift left=8pt, "\Rightarrow"]
		\ar[r, phantom, shift right=8pt, "\Leftarrow"]
	&
	\poly_B
\end{tikzcd}
\end{equation}
where $\poly_X$ is the category of polynomials with positions $p(1)=X$. The images under the functors $f_!$ and $f_*$ of $p:\poly_A$ are given by
\begin{equation}
	f_!(p)\coloneqq\sum_{b: B}\yon^{\;\prod\limits_{b=fa}p[a]}
	\qqand
	f_*(p)\coloneqq\sum_{b: B}\yon^{\;\sum\limits_{b=fa}p[a]}
\end{equation}
and the image under the functor $f^*$ of $q:\poly_B$ is given by
\begin{equation}
	f^*(q)\coloneqq\sum_{a: A}\yon^{q[fa]}
\end{equation}
For any $p:\poly_A$ and $q:\poly_B$ there are natural maps
\begin{equation}
	p\to f_!(p)
	\qqand
	f^*(q)\to q.
\end{equation}

A morphism $\varphi\colon p\to q$ can be identified with a diagram of the form
\begin{equation}\label{eqn.poly_map}
\begin{tikzcd}
	p(1)\ar[d, "\varphi_1"']\ar[r, "{p[-]}", ""' name=p]&
	\smset\\
	q(1)\ar[ur, bend right, "{q[-]}"', "" name=q]
	\ar[to=p, from=q-|p, Rightarrow, shorten=3pt, "\varphi^\sharp"]
\end{tikzcd}
\end{equation}
The $p\mapsto p(1)$ bifibration \eqref{eqn.bifib} gives us the terms \emph{vertical, cartesian, \text{and} op-cartesian} for a map $\varphi\colon p\to q$ in $\poly$. That is, taking $f\coloneqq\varphi_1$, we have that $\varphi$ is vertical if it is contained in a fiber of the bifibration \eqref{eqn.bifib}, it is cartesian if $p\to f^*(q)$ is an isomorphism, and it is op-cartesian if $f_!(p)\to q$ is an isomorphism. Here are alternative ways to define these notions: $\varphi$ is 
\begin{itemize}
	\item \emph{vertical} if $\varphi_1\colon p(1)\to q(1)$ is an identity in $\smset$,
	\item \emph{cartesian} if $\varphi^\sharp$ is a natural isomorphism, and
	\item \emph{op-cartesian} if the diagram \eqref{eqn.poly_map} is a right Kan extension.
\end{itemize}
More explicitly, $\varphi$ is cartesian iff for each $I: p(1)$, the function $\varphi^\sharp_I\colon p[I]\to q[\varphi_1I]$ is a bijection. It is op-cartesian if for each $J: q(1)$ the map $q[J]\to\prod\limits_{\varphi_1(I)=J}p[I]$ is a bijection.

There are at least three factorization systems on $\poly$:
\begin{itemize}
	\item (epi, mono),
	\item (vertical, cartesian), and
	\item (op-cartesian, vertical).
\end{itemize}


\section*{Acknowledgments}
This material is based upon work supported by the Air Force Office of Scientific Research under award number FA9550-20-1-0348.

\printbibliography 
\end{document}
